<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Doppio18 üíô</title>
<style>
  body {
    font-family: 'Poppins', sans-serif;
    background: linear-gradient(135deg, #065369, #044152);
    text-align: center;
    padding: 20px;
    margin: 0;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    color: #a5c2c9;
  }
  h1 {
    color: #a5c2c9;
    font-size: 2rem;
    margin-bottom: 10px;
  }
  #turnCounter {
    font-weight: bold;
    font-size: 1.2rem;
    margin: 10px 0;
    color: #a5c2c9;
  }
  .mazzi, .carte-scoperte {
    display: flex;
    justify-content: center;
    gap: 25px;
    margin: 10px 0;
    flex-wrap: wrap;
  }
  .mazzo {
    background-color: #06627a;
    color: #a5c2c9;
    border-radius: 15px;
    width: 80px;
    height: 120px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 18px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.5);
  }
  .carta {
    background: #ffffff;
    color: #000;
    border: 3px solid #0a6b83;
    border-radius: 15px;
    width: 120px;
    height: 160px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 0.9rem;
    font-weight: bold;
    padding: 10px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.3);
  }
  .carta.sfida { border-color: #17cafc; color: #17cafc; }
  .carta.obbligo { border-color: #ba0000; color: #ba0000; }
  .carta.speciale { border-color: #bb0bd6; color: #bb0bd6; }

  li.sfida { color: #17cafc; border-left: 4px solid #17cafc; }
  li.obbligo { color: #ba0000; border-left: 4px solid #ba0000; }
  li.speciale { color: #bb0bd6; border-left: 4px solid #bb0bd6; }

  button {
    margin: 8px;
    padding: 12px 22px;
    font-size: 1rem;
    border: none;
    border-radius: 25px;
    font-weight: bold;
    color: white;
    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    transition: transform 0.2s, background 0.3s;
  }
  button:active { transform: scale(0.95); }
  button:hover { opacity: 0.9; }
  button.scopri {
    background: linear-gradient(45deg, #ffd700, #ffea70);
    color: #333;
    text-shadow: 0 0 5px rgba(255,255,255,0.7);
  }
  button.verde {
    background: #4caf50;
    color: #fff;
  }
  #scoreBoard {
    margin-top: 15px;
    font-size: 1rem;
    background: #0a6b83;
    border-radius: 15px;
    padding: 10px;
    width: 90%;
    max-width: 350px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
  }
  #scoreBoard p { margin: 5px 0; color: #a5c2c9; }
  #scoreBoard button { background: #044f5f; color: #a5c2c9; }
  .history-button {
    position: fixed;
    top: 50%;
    transform: translateY(-50%);
    font-size: 2rem;
    background: none;
    border: none;
    cursor: pointer;
    color: #a5c2c9;
  }
  #history1 { left: 10px; }
  #history2 { right: 10px; }
  .drawer {
    position: fixed;
    top: 0;
    width: 80%;
    max-width: 300px;
    height: 100%;
    background: rgba(10,107,131,0.95);
    color: #a5c2c9;
    box-shadow: 0 0 15px rgba(0,0,0,0.6);
    overflow-y: auto;
    transition: transform 0.3s ease;
    padding: 20px;
    z-index: 1000;
  }
  .drawer.left { left: 0; transform: translateX(-100%); }
  .drawer.right { right: 0; transform: translateX(100%); }
  .drawer.open { transform: translateX(0); }
  .drawer h2, .drawer h3 { color: #a5c2c9; }
  .drawer ul { list-style: none; padding: 0; margin: 0 0 15px; }
  .drawer li { background: rgba(255,255,255,0.1); margin: 5px 0; padding: 6px 8px; border-radius: 8px; font-size: 0.9rem; color: #a5c2c9; }
  .close-drawer { position: absolute; top: 10px; right: 15px; font-size: 1.5rem; cursor: pointer; color: #a5c2c9; }
</style>
</head>
<body>
<h1>Doppio18 üíô</h1>
<div id="turnCounter">Turno: 1 | Giocatore 1</div>
<div class="mazzi">
  <div id="mazzo1" class="mazzo">18</div>
  <div id="mazzo2" class="mazzo">18</div>
</div>
<div class="carte-scoperte">
  <div id="carta1" class="carta" style="color:#a5c2c9;">?</div>
  <div id="carta2" class="carta" style="color:#a5c2c9;">?</div>
</div>
<div>
  <button class="scopri" onclick="scopriCarte()">üîç Scopri carte</button>
  <button class="verde" onclick="scegliCarta('sinistra')">‚¨ÖÔ∏è Scegli sinistra</button>
  <button class="verde" onclick="scegliCarta('destra')">‚û°Ô∏è Scegli destra</button>
</div>
<div id="scoreBoard">
  <p>üèÜ Giocatore 1: <span id="score1">0</span></p>
  <p>üèÜ Giocatore 2: <span id="score2">0</span></p>
  <button onclick="addPoint(1)">+1 Giocatore 1</button>
  <button onclick="addPoint(2)">+1 Giocatore 2</button>
</div>

<button id="history1" class="history-button" onclick="toggleDrawer('left')">‚è±Ô∏è</button>
<button id="history2" class="history-button" onclick="toggleDrawer('right')">‚è±Ô∏è</button>

<div id="drawer-left" class="drawer left">
  <span class="close-drawer" onclick="toggleDrawer('left')">‚úñ</span>
  <h2>Giocatore 1</h2>
  <h3>Carte Scelte</h3>
  <ul id="scelte1"></ul>
  <h3>Carte Scartate</h3>
  <ul id="scartate1"></ul>
</div>
<div id="drawer-right" class="drawer right">
  <span class="close-drawer" onclick="toggleDrawer('right')">‚úñ</span>
  <h2>Giocatore 2</h2>
  <h3>Carte Scelte</h3>
  <ul id="scelte2"></ul>
  <h3>Carte Scartate</h3>
  <ul id="scartate2"></ul>
</div>

<script>
const carte = [
  'Cala e Scopri','Trentuno','Bella a scopa','Rigori','Mazzo','Tivit','Corsa dei Cavalli','Testa Croce','Bandiere','Canzone','Tris','Forza 4','BlockBlast 5000','Impiccato','Numeri in Codice','Formichina','Planck','Ruba Indumento','Bacio Rubato','Lunghezza d\'onda(Indovina)','Lunghezza d\'onda(Scegli)','Sfida Casuale','Random Totale','1 shottino','2 shottini','Switch','Ripeti Sfida di Prima','Sceglie l\'avversario','Il Migliore beve','Switch','Previsione','Comando','Sfida Precedente','Cambio','Blocco','Scelta Finale'
];

let mazzo1 = [];
let mazzo2 = [];
let cartaSinistra = null;
let cartaDestra = null;
let turno = 1;
let giocatore = 1;
let scelte = {1: [], 2: []};
let scartate = {1: [], 2: []};
let score = {1: 0, 2: 0};

function mischia(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

function inizializza() {
  const mazzoMischiato = mischia([...carte]);
  mazzo1 = mazzoMischiato.slice(0, 18);
  mazzo2 = mazzoMischiato.slice(18);
  aggiornaMazzi();
}

function aggiornaMazzi() {
  document.getElementById('mazzo1').innerText = mazzo1.length;
  document.getElementById('mazzo2').innerText = mazzo2.length;
}

function getTipoCarta(nome) {
  const sfide = ['Cala e Scopri','Trentuno','Bella a scopa','Rigori','Mazzo','Tivit','Corsa dei Cavalli','Testa Croce','Bandiere','Canzone','Tris','Forza 4','BlockBlast 5000','Impiccato','Numeri in Codice','Formichina','Planck','Ruba Indumento','Bacio Rubato','Lunghezza d\'onda(Indovina)','Lunghezza d\'onda(Scegli)','Sfida Casuale','Random Totale'];
  const obblighi = ['1 shottino','2 shottini','Switch','Ripeti Sfida di Prima','Sceglie l\'avversario','Il Migliore beve'];
  const speciali = ['Switch','Previsione','Comando','Sfida Precedente','Cambio','Blocco','Scelta Finale'];

  if (sfide.includes(nome)) return 'sfida';
  if (obblighi.includes(nome)) return 'obbligo';
  if (speciali.includes(nome)) return 'speciale';
  return '';
}

function applicaStileCarta(elemento, tipo) {
  elemento.classList.remove('sfida','obbligo','speciale');
  if (tipo) elemento.classList.add(tipo);
}

function scopriCarte() {
  if (mazzo1.length === 0 || mazzo2.length === 0) {
    alert('Fine mazzi!');
    return;
  }
  cartaSinistra = mazzo1[mazzo1.length - 1];
  cartaDestra = mazzo2[mazzo2.length - 1];
  const carta1El = document.getElementById('carta1');
  const carta2El = document.getElementById('carta2');
  carta1El.innerText = cartaSinistra;
  carta2El.innerText = cartaDestra;
  applicaStileCarta(carta1El, getTipoCarta(cartaSinistra));
  applicaStileCarta(carta2El, getTipoCarta(cartaDestra));
}

function scegliCarta(lato) {
  if (!cartaSinistra || !cartaDestra) {
    alert('Devi prima scoprire le carte!');
    return;
  }
  if (lato === 'sinistra') {
    scelte[giocatore].push(cartaSinistra);
    scartate[giocatore].push(cartaDestra);
  } else {
    scelte[giocatore].push(cartaDestra);
    scartate[giocatore].push(cartaSinistra);
  }
  aggiornaStorico();
  fineTurno();
}

function fineTurno() {
  if (mazzo1.length > 0) mazzo1.pop();
  if (mazzo2.length > 0) mazzo2.pop();
  aggiornaMazzi();
  cartaSinistra = null;
  cartaDestra = null;
  const c1 = document.getElementById('carta1');
  const c2 = document.getElementById('carta2');
  c1.innerText = '?';
  c2.innerText = '?';
  c1.className = 'carta';
  c2.className = 'carta';
  turno++;
  giocatore = giocatore === 1 ? 2 : 1;
  document.getElementById('turnCounter').innerText = `Turno: ${turno} | Giocatore ${giocatore}`;
  if (turno % 6 === 0) {
    alert('üç∏ Round Obbligo & Verit√†!');
  }
}

function addPoint(player) {
  score[player]++;
  document.getElementById(`score${player}`).innerText = score[player];
}

function aggiornaStorico() {
  for (let i = 1; i <= 2; i++) {
    const scelteList = document.getElementById(`scelte${i}`);
    const scartateList = document.getElementById(`scartate${i}`);
    scelteList.innerHTML = scelte[i].map(c => `<li class="${getTipoCarta(c)}">${c}</li>`).join('');
    scartateList.innerHTML = scartate[i].map(c => `<li class="${getTipoCarta(c)}">${c}</li>`).join('');
  }
}

function toggleDrawer(side) {
  const drawer = document.getElementById(`drawer-${side}`);
  drawer.classList.toggle('open');
}

inizializza();
</script>
</body>
</html>
